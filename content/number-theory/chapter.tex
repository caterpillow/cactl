\chapter{Number theory}

\section{Modular arithmetic}
	\kactlimport{ModularArithmetic.h}
	\kactlimport{ModInverse.h}
	\kactlimport{ModPow.h}
	\kactlimport{ModLog.h}
	\kactlimport{ModSum.h}
	\kactlimport{ModMulLL.h}
	\kactlimport{ModSqrt.h}

\section{Primality}
	\kactlimport{FastEratosthenes.h}
	\kactlimport{MillerRabin.h}
	\kactlimport{Factor.h}
	\kactlimport{PrimeCnt.h}

\section{Divisibility}
	\kactlimport{euclid.h}
	\kactlimport{Euclid.java}
	\kactlimport{CRT.h}

	\subsection{BÃ©zout's identity}
	For $a \neq $, $b \neq 0$, then $d=gcd(a,b)$ is the smallest positive integer for which there are integer solutions to
	$$ax+by=d$$
	If $(x,y)$ is one solution, then all solutions are given by
	$$\left(x+\frac{kb}{\gcd(a,b)}, y-\frac{ka}{\gcd(a,b)}\right), \quad k\in\mathbb{Z}$$

	\kactlimport{phiFunction.h}

\section{Fractions}
	\subsection{Continued Fractions}
	Let $a_0,a_1,\ldots,a_n\in\mathbb{Z}$ and $a_1,a_2,\ldots,a_n\ge 1$. Then the expression
	\[ r = a_0 + \cfrac{1}{\,a_1 + \cfrac{1}{\,\ddots + \cfrac{1}{a_n}}}\,, \]
	is called the \emph{continued fraction representation} of the rational number $r$
	and is denoted shortly as
	\[ r = [a_0; a_1, a_2, \ldots, a_k]. \]
	If $a_0 > 0$ then $\frac{1}{r}$ is given by sticking a $0$ in front. If $a_0 = 0$ then ditch the first term. \\ 
	$[a_0, a_1, \dots, a_n - 1]$ gives the run-length encoding (right first) of $r$'s path in the Stern-Brocot tree. \\ 
	$r_k = [a_0; a_1, a_2, \dots, a_k] = \frac{p_k}{q_k}$ is called the $k$-th \emph{convergent} of $r$. \\
	Semiconvergents are convergents but you can lower the last number down to 1. \\
	Consider the convex hull of points above and below $y = rx$. Odd convergents $(q_k; p_k)$ give vertices of the upper hull, while even convergents give the vertices of the lower hull. \\
	The set of semiconvergents = set of lattice points on the hulls. Combine these facts with Pick's theorem for funny stuff. \\

	\kactlimport{SBT.h}
	\kactlimport{ContinuedFractions.h}
	\kactlimport{FracBinarySearch.h}

\section{Pythagorean Triples}
 The Pythagorean triples are uniquely generated by
 \[ a=k\cdot (m^{2}-n^{2}),\ \,b=k\cdot (2mn),\ \,c=k\cdot (m^{2}+n^{2}), \]
 with $m > n > 0$, $k > 0$, $m \bot n$, and either $m$ or $n$ even.

\section{Primes}
	$p=962592769$ is such that $2^{21} \mid p-1$, which may be useful. For hashing
	use 970592641 (31-bit number), 31443539979727 (45-bit), 3006703054056749
	(52-bit). There are 78498 primes less than 1\,000\,000.

	Primitive roots exist modulo any prime power $p^a$, except for $p = 2, a > 2$, and there are $\phi(\phi(p^a))$ many.
	For $p = 2, a > 2$, the group $\mathbb Z_{2^a}^\times$ is instead isomorphic to $\mathbb Z_2 \times \mathbb Z_{2^{a-2}}$.

\section{Estimates}
	$\sum_{d|n} d = O(n \log \log n)$.

	The number of divisors of $n$ is at most around 100 for $n < 5e4$, 250 for $n < 1e6$, 500 for $n < 1e7$, 2000 for $n < 1e10$, 200\,000 for $n < 1e19$.

\section{Mobius Function}
\[
	\mu(n) = \begin{cases} 0 & n \textrm{ is not square free}\\ 1 & n \textrm{ has even number of prime factors}\\ -1 & n \textrm{ has odd number of prime factors}\\\end{cases}
\]
  Mobius Inversion:
  \[ g(n) = \sum_{d|n} f(d) \Leftrightarrow f(n) = \sum_{d|n} \mu(d)g(n/d) \]
  Other useful formulas/forms:

  $ \sum_{d | n} \mu(d) = [ n = 1] $ (very useful)

  $ g(n) = \sum_{n|d} f(d) \Leftrightarrow f(n) = \sum_{n|d} \mu(d/n)g(d)$

 $ g(n) = \sum_{1 \leq m \leq n} f(\left\lfloor\frac{n}{m}\right \rfloor ) \Leftrightarrow f(n) = \sum_{1\leq m\leq n} \mu(m)g(\left\lfloor\frac{n}{m}\right\rfloor)$
